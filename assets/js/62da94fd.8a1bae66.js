"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[6111],{3173:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>a,default:()=>m,frontMatter:()=>t,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"module2-digital-twin/physics-simulation-environment-building","title":"Physics Simulation and Environment Building","description":"Introduction to Digital Twins","source":"@site/docs/module2-digital-twin/physics-simulation-environment-building.md","sourceDirName":"module2-digital-twin","slug":"/module2-digital-twin/physics-simulation-environment-building","permalink":"/-physical-ai-textbook_01/docs/module2-digital-twin/physics-simulation-environment-building","draft":false,"unlisted":false,"editUrl":"https://github.com/umernasir1/physical-ai-textbook/tree/main/docs/module2-digital-twin/physics-simulation-environment-building.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Physics Simulation and Environment Building"},"sidebar":"tutorialSidebar","previous":{"title":"Module 2: The Digital Twin (Gazebo & Unity)","permalink":"/-physical-ai-textbook_01/docs/category/module-2-the-digital-twin-gazebo--unity"},"next":{"title":"High-fidelity Rendering and Human-Robot Interaction","permalink":"/-physical-ai-textbook_01/docs/module2-digital-twin/high-fidelity-rendering-human-robot-interaction"}}');var s=i(4848),l=i(8453);const t={sidebar_position:1,title:"Physics Simulation and Environment Building"},a="Physics Simulation and Environment Building",r={},c=[{value:"Introduction to Digital Twins",id:"introduction-to-digital-twins",level:2},{value:"Why Gazebo for Physical AI?",id:"why-gazebo-for-physical-ai",level:2},{value:"Getting Started with Gazebo",id:"getting-started-with-gazebo",level:2},{value:"Installation (Ubuntu 22.04)",id:"installation-ubuntu-2204",level:3},{value:"Gazebo Architecture",id:"gazebo-architecture",level:3},{value:"Understanding Physics Engines",id:"understanding-physics-engines",level:2},{value:"Choosing a Physics Engine",id:"choosing-a-physics-engine",level:3},{value:"Building Your First World File",id:"building-your-first-world-file",level:2},{value:"Basic World Structure",id:"basic-world-structure",level:3},{value:"Adding a Ground Plane with Friction",id:"adding-a-ground-plane-with-friction",level:3},{value:"Simulating Gravity and Physical Forces",id:"simulating-gravity-and-physical-forces",level:2},{value:"Adjusting Gravity",id:"adjusting-gravity",level:3},{value:"Wind Forces",id:"wind-forces",level:3},{value:"Collision Detection and Response",id:"collision-detection-and-response",level:2},{value:"Collision Geometry Types",id:"collision-geometry-types",level:3},{value:"Contact Properties for Humanoid Feet",id:"contact-properties-for-humanoid-feet",level:3},{value:"Building Complex Environments",id:"building-complex-environments",level:2},{value:"Creating an Indoor Navigation Scene",id:"creating-an-indoor-navigation-scene",level:3},{value:"Adding Dynamic Objects",id:"adding-dynamic-objects",level:3},{value:"Spawning Robots in Gazebo",id:"spawning-robots-in-gazebo",level:2},{value:"Method 1: Include in World File",id:"method-1-include-in-world-file",level:3},{value:"Method 2: Spawn via ROS 2 Service",id:"method-2-spawn-via-ros-2-service",level:3},{value:"Gazebo Plugins for Robot Control",id:"gazebo-plugins-for-robot-control",level:2},{value:"Joint Position Controller Plugin",id:"joint-position-controller-plugin",level:3},{value:"Joint Effort Controller",id:"joint-effort-controller",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Simulation Speed vs. Accuracy Trade-offs",id:"simulation-speed-vs-accuracy-trade-offs",level:3},{value:"Collision Optimization",id:"collision-optimization",level:3},{value:"Level of Detail (LOD)",id:"level-of-detail-lod",level:3},{value:"Creating Custom Gazebo Models",id:"creating-custom-gazebo-models",level:2},{value:"Directory Structure",id:"directory-structure",level:3},{value:"model.config",id:"modelconfig",level:3},{value:"model.sdf (Simplified)",id:"modelsdf-simplified",level:3},{value:"Installing Custom Models",id:"installing-custom-models",level:3},{value:"Debugging Simulation Issues",id:"debugging-simulation-issues",level:2},{value:"Common Problems and Solutions",id:"common-problems-and-solutions",level:3},{value:"Visualization Tools",id:"visualization-tools",level:3},{value:"Practical Exercise: Building a Humanoid Test Arena",id:"practical-exercise-building-a-humanoid-test-arena",level:2},{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"physics-simulation-and-environment-building",children:"Physics Simulation and Environment Building"})}),"\n",(0,s.jsx)(e.h2,{id:"introduction-to-digital-twins",children:"Introduction to Digital Twins"}),"\n",(0,s.jsxs)(e.p,{children:["A ",(0,s.jsx)(e.strong,{children:"Digital Twin"})," is a virtual replica of a physical system that accurately simulates its behavior in the real world. For robotics, digital twins enable:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Safe Testing"}),": Experiment with robot behaviors without risking hardware damage"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Rapid Prototyping"}),": Iterate on designs quickly before physical manufacturing"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Training AI"}),": Generate synthetic data for machine learning models"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Sim-to-Real Transfer"}),": Develop control algorithms that work in both simulation and reality"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["In this chapter, we'll explore ",(0,s.jsx)(e.strong,{children:"Gazebo"}),", the industry-standard physics simulator for ROS 2, and learn how to create realistic environments for humanoid robot testing."]}),"\n",(0,s.jsx)(e.h2,{id:"why-gazebo-for-physical-ai",children:"Why Gazebo for Physical AI?"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Gazebo"})," is an open-source 3D robotics simulator that provides:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Accurate Physics"}),": ODE, Bullet, Simbody, and DART physics engines"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Rich Sensor Support"}),": Cameras, LiDAR, IMUs, force/torque sensors"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"ROS 2 Integration"}),": Seamless communication with robot control systems"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Plugin Architecture"}),": Extensible for custom behaviors"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Distributed Simulation"}),": Run physics on different machines"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Industry Adoption:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"NASA uses Gazebo for space robotics"}),"\n",(0,s.jsx)(e.li,{children:"DARPA Robotics Challenge simulations"}),"\n",(0,s.jsx)(e.li,{children:"Autonomous vehicle testing (CARLA is built on Unreal, but Gazebo remains dominant for robots)"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"getting-started-with-gazebo",children:"Getting Started with Gazebo"}),"\n",(0,s.jsx)(e.h3,{id:"installation-ubuntu-2204",children:"Installation (Ubuntu 22.04)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Install Gazebo Garden (recommended for ROS 2 Humble)\nsudo apt-get update\nsudo apt-get install ros-humble-gazebo-ros-pkgs\n\n# Verify installation\ngazebo --version\n\n# Launch Gazebo\ngazebo\n"})}),"\n",(0,s.jsx)(e.h3,{id:"gazebo-architecture",children:"Gazebo Architecture"}),"\n",(0,s.jsx)(e.p,{children:"Gazebo consists of two main components:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"gzserver"}),": Physics simulation and sensor generation (headless)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"gzclient"}),": GUI for visualization and interaction"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Run server only (for training, no GUI overhead)\ngzserver worlds/my_world.world\n\n# Run client (connect to existing server)\ngzclient\n"})}),"\n",(0,s.jsx)(e.h2,{id:"understanding-physics-engines",children:"Understanding Physics Engines"}),"\n",(0,s.jsx)(e.p,{children:"Gazebo supports multiple physics engines. Each has trade-offs:"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Engine"}),(0,s.jsx)(e.th,{children:"Strengths"}),(0,s.jsx)(e.th,{children:"Weaknesses"}),(0,s.jsx)(e.th,{children:"Best For"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.strong,{children:"ODE"})," (Default)"]}),(0,s.jsx)(e.td,{children:"Fast, stable, widely used"}),(0,s.jsx)(e.td,{children:"Less accurate contacts"}),(0,s.jsx)(e.td,{children:"General robotics"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Bullet"})}),(0,s.jsx)(e.td,{children:"Realistic collisions, open-source"}),(0,s.jsx)(e.td,{children:"Slower than ODE"}),(0,s.jsx)(e.td,{children:"Manipulation tasks"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"DART"})}),(0,s.jsx)(e.td,{children:"Accurate dynamics, constraint handling"}),(0,s.jsx)(e.td,{children:"Steep learning curve"}),(0,s.jsx)(e.td,{children:"Bipedal locomotion"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Simbody"})}),(0,s.jsx)(e.td,{children:"High-fidelity biomechanics"}),(0,s.jsx)(e.td,{children:"Computationally expensive"}),(0,s.jsx)(e.td,{children:"Human motion simulation"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"choosing-a-physics-engine",children:"Choosing a Physics Engine"}),"\n",(0,s.jsxs)(e.p,{children:["For humanoid robots, ",(0,s.jsx)(e.strong,{children:"DART"})," is recommended because:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Handles complex multi-body dynamics (many joints)"}),"\n",(0,s.jsx)(e.li,{children:"Stable contact dynamics for foot-ground interaction"}),"\n",(0,s.jsx)(e.li,{children:"Accurate constraint resolution for balance control"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<world name="humanoid_world">\n  <physics name="dart_physics" type="dart">\n    <max_step_size>0.001</max_step_size>\n    <real_time_factor>1</real_time_factor>\n    <real_time_update_rate>1000</real_time_update_rate>\n  </physics>\n</world>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"building-your-first-world-file",children:"Building Your First World File"}),"\n",(0,s.jsxs)(e.p,{children:["World files (",(0,s.jsx)(e.code,{children:".world"}),") define the simulation environment. They use ",(0,s.jsx)(e.strong,{children:"SDF (Simulation Description Format)"}),"."]}),"\n",(0,s.jsx)(e.h3,{id:"basic-world-structure",children:"Basic World Structure"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.6">\n  <world name="simple_world">\n\n    \x3c!-- Lighting --\x3e\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Gravity --\x3e\n    <gravity>0 0 -9.81</gravity>\n\n    \x3c!-- Physics Engine Configuration --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1</real_time_factor>\n    </physics>\n\n    \x3c!-- Ground Plane --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n  </world>\n</sdf>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"adding-a-ground-plane-with-friction",children:"Adding a Ground Plane with Friction"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<model name="ground_plane">\n  <static>true</static>\n  <link name="link">\n    <collision name="collision">\n      <geometry>\n        <plane>\n          <normal>0 0 1</normal>\n          <size>100 100</size>\n        </plane>\n      </geometry>\n      <surface>\n        <friction>\n          <ode>\n            <mu>1.0</mu>    \x3c!-- Coefficient of friction --\x3e\n            <mu2>1.0</mu2>\n          </ode>\n        </friction>\n        <contact>\n          <ode>\n            <kp>1000000.0</kp>  \x3c!-- Contact stiffness --\x3e\n            <kd>100.0</kd>       \x3c!-- Contact damping --\x3e\n          </ode>\n        </contact>\n      </surface>\n    </collision>\n    <visual name="visual">\n      <geometry>\n        <plane>\n          <normal>0 0 1</normal>\n          <size>100 100</size>\n        </plane>\n      </geometry>\n      <material>\n        <ambient>0.8 0.8 0.8 1</ambient>\n        <diffuse>0.8 0.8 0.8 1</diffuse>\n      </material>\n    </visual>\n  </link>\n</model>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"simulating-gravity-and-physical-forces",children:"Simulating Gravity and Physical Forces"}),"\n",(0,s.jsx)(e.h3,{id:"adjusting-gravity",children:"Adjusting Gravity"}),"\n",(0,s.jsx)(e.p,{children:"For testing balance algorithms, you can modify gravity:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"\x3c!-- Earth gravity --\x3e\n<gravity>0 0 -9.81</gravity>\n\n\x3c!-- Moon gravity (1/6th of Earth) --\x3e\n<gravity>0 0 -1.625</gravity>\n\n\x3c!-- Mars gravity --\x3e\n<gravity>0 0 -3.71</gravity>\n\n\x3c!-- Zero gravity (space simulation) --\x3e\n<gravity>0 0 0</gravity>\n"})}),"\n",(0,s.jsx)(e.h3,{id:"wind-forces",children:"Wind Forces"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<plugin name="wind" filename="libgazebo_ros_wind.so">\n  <frame_id>world</frame_id>\n  <wind_force_mean>5.0 0.0 0.0</wind_force_mean>  \x3c!-- 5 m/s wind in X direction --\x3e\n  <wind_force_variance>1.0</wind_force_variance>\n</plugin>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"collision-detection-and-response",children:"Collision Detection and Response"}),"\n",(0,s.jsx)(e.h3,{id:"collision-geometry-types",children:"Collision Geometry Types"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Box Collision --\x3e\n<collision name="box_collision">\n  <geometry>\n    <box>\n      <size>1 1 1</size>\n    </box>\n  </geometry>\n</collision>\n\n\x3c!-- Sphere Collision --\x3e\n<collision name="sphere_collision">\n  <geometry>\n    <sphere>\n      <radius>0.5</radius>\n    </sphere>\n  </geometry>\n</collision>\n\n\x3c!-- Cylinder Collision --\x3e\n<collision name="cylinder_collision">\n  <geometry>\n    <cylinder>\n      <radius>0.3</radius>\n      <length>1.0</length>\n    </cylinder>\n  </geometry>\n</collision>\n\n\x3c!-- Mesh Collision (for complex shapes) --\x3e\n<collision name="mesh_collision">\n  <geometry>\n    <mesh>\n      <uri>model://my_model/meshes/collision.stl</uri>\n      <scale>1 1 1</scale>\n    </mesh>\n  </geometry>\n</collision>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"contact-properties-for-humanoid-feet",children:"Contact Properties for Humanoid Feet"}),"\n",(0,s.jsx)(e.p,{children:"Critical for stable bipedal locomotion:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<surface>\n  <friction>\n    <ode>\n      <mu>1.5</mu>     \x3c!-- High friction prevents slipping --\x3e\n      <mu2>1.5</mu2>\n      <slip1>0.0</slip1>\n      <slip2>0.0</slip2>\n    </ode>\n  </friction>\n  <contact>\n    <ode>\n      <kp>10000000.0</kp>  \x3c!-- Very stiff contact (floor is hard) --\x3e\n      <kd>100.0</kd>        \x3c!-- Damping prevents bouncing --\x3e\n      <max_vel>0.01</max_vel>\n      <min_depth>0.001</min_depth>\n    </ode>\n  </contact>\n  <bounce>\n    <restitution_coefficient>0.0</restitution_coefficient>  \x3c!-- No bounce --\x3e\n  </bounce>\n</surface>\n"})}),"\n",(0,s.jsx)(e.h2,{id:"building-complex-environments",children:"Building Complex Environments"}),"\n",(0,s.jsx)(e.h3,{id:"creating-an-indoor-navigation-scene",children:"Creating an Indoor Navigation Scene"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<world name="indoor_lab">\n\n  \x3c!-- Room Walls --\x3e\n  <model name="wall_north">\n    <static>true</static>\n    <pose>0 5 1.25 0 0 0</pose>\n    <link name="link">\n      <collision name="collision">\n        <geometry>\n          <box>\n            <size>10 0.2 2.5</size>\n          </box>\n        </geometry>\n      </collision>\n      <visual name="visual">\n        <geometry>\n          <box>\n            <size>10 0.2 2.5</size>\n          </box>\n        </geometry>\n        <material>\n          <ambient>0.7 0.7 0.7 1</ambient>\n        </material>\n      </visual>\n    </link>\n  </model>\n\n  \x3c!-- Repeat for south, east, west walls --\x3e\n\n  \x3c!-- Obstacles --\x3e\n  <model name="table">\n    <static>true</static>\n    <pose>2 2 0.4 0 0 0</pose>\n    <link name="link">\n      <collision name="collision">\n        <geometry>\n          <box>\n            <size>1.5 0.8 0.8</size>\n          </box>\n        </geometry>\n      </collision>\n      <visual name="visual">\n        <geometry>\n          <box>\n            <size>1.5 0.8 0.8</size>\n          </box>\n        </geometry>\n        <material>\n          <ambient>0.6 0.4 0.2 1</ambient>\n        </material>\n      </visual>\n    </link>\n  </model>\n\n  \x3c!-- Chair --\x3e\n  <include>\n    <uri>model://chair</uri>\n    <pose>2 3 0 0 0 1.57</pose>\n  </include>\n\n</world>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"adding-dynamic-objects",children:"Adding Dynamic Objects"}),"\n",(0,s.jsx)(e.p,{children:"Objects that the humanoid can interact with:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<model name="soda_can">\n  <pose>1 1 0.6 0 0 0</pose>  \x3c!-- On table --\x3e\n  <link name="link">\n    <inertial>\n      <mass>0.390</mass>  \x3c!-- 390g full soda can --\x3e\n      <inertia>\n        <ixx>0.00058</ixx>\n        <iyy>0.00058</iyy>\n        <izz>0.00019</izz>\n      </inertia>\n    </inertial>\n    <collision name="collision">\n      <geometry>\n        <cylinder>\n          <radius>0.031</radius>\n          <length>0.115</length>\n        </cylinder>\n      </geometry>\n    </collision>\n    <visual name="visual">\n      <geometry>\n        <cylinder>\n          <radius>0.031</radius>\n          <length>0.115</length>\n        </cylinder>\n      </geometry>\n      <material>\n        <ambient>1 0 0 1</ambient>  \x3c!-- Red can --\x3e\n      </material>\n    </visual>\n  </link>\n</model>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"spawning-robots-in-gazebo",children:"Spawning Robots in Gazebo"}),"\n",(0,s.jsx)(e.h3,{id:"method-1-include-in-world-file",children:"Method 1: Include in World File"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<world name="my_world">\n  <include>\n    <uri>model://my_humanoid</uri>\n    <name>robot1</name>\n    <pose>0 0 1.0 0 0 0</pose>  \x3c!-- x y z roll pitch yaw --\x3e\n  </include>\n</world>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"method-2-spawn-via-ros-2-service",children:"Method 2: Spawn via ROS 2 Service"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Spawn URDF model\nros2 run gazebo_ros spawn_entity.py -entity my_robot -file ~/robot.urdf -x 0 -y 0 -z 1.0\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# Python script to spawn robot\nimport rclpy\nfrom gazebo_msgs.srv import SpawnEntity\n\ndef spawn_robot():\n    node = rclpy.create_node('robot_spawner')\n    client = node.create_client(SpawnEntity, '/spawn_entity')\n\n    while not client.wait_for_service(timeout_sec=1.0):\n        node.get_logger().info('Waiting for spawn service...')\n\n    # Read URDF file\n    with open('/path/to/robot.urdf', 'r') as f:\n        robot_desc = f.read()\n\n    request = SpawnEntity.Request()\n    request.name = 'my_humanoid'\n    request.xml = robot_desc\n    request.initial_pose.position.x = 0.0\n    request.initial_pose.position.y = 0.0\n    request.initial_pose.position.z = 1.0\n\n    future = client.call_async(request)\n    rclpy.spin_until_future_complete(node, future)\n\n    node.destroy_node()\n\nif __name__ == '__main__':\n    rclpy.init()\n    spawn_robot()\n    rclpy.shutdown()\n"})}),"\n",(0,s.jsx)(e.h2,{id:"gazebo-plugins-for-robot-control",children:"Gazebo Plugins for Robot Control"}),"\n",(0,s.jsx)(e.h3,{id:"joint-position-controller-plugin",children:"Joint Position Controller Plugin"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<gazebo>\n  <plugin name="gazebo_ros_joint_state_publisher"\n          filename="libgazebo_ros_joint_state_publisher.so">\n    <ros>\n      <namespace>/my_robot</namespace>\n      <remapping>~/out:=joint_states</remapping>\n    </ros>\n    <update_rate>100</update_rate>\n    <joint_name>left_hip_pitch</joint_name>\n    <joint_name>left_knee</joint_name>\n    <joint_name>right_hip_pitch</joint_name>\n    <joint_name>right_knee</joint_name>\n  </plugin>\n</gazebo>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"joint-effort-controller",children:"Joint Effort Controller"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<gazebo>\n  <plugin name="gazebo_ros_joint_effort"\n          filename="libgazebo_ros_joint_effort.so">\n    <ros>\n      <namespace>/my_robot</namespace>\n      <remapping>~/command:=joint_effort</remapping>\n    </ros>\n    <joint_name>left_knee</joint_name>\n  </plugin>\n</gazebo>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,s.jsx)(e.h3,{id:"simulation-speed-vs-accuracy-trade-offs",children:"Simulation Speed vs. Accuracy Trade-offs"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<physics type="ode">\n  \x3c!-- High accuracy (slower) --\x3e\n  <max_step_size>0.0001</max_step_size>  \x3c!-- 10 kHz --\x3e\n  <real_time_factor>0.5</real_time_factor>  \x3c!-- Runs at 0.5x real-time --\x3e\n\n  \x3c!-- Balanced --\x3e\n  <max_step_size>0.001</max_step_size>  \x3c!-- 1 kHz --\x3e\n  <real_time_factor>1.0</real_time_factor>\n\n  \x3c!-- Fast (less accurate) --\x3e\n  <max_step_size>0.01</max_step_size>  \x3c!-- 100 Hz --\x3e\n  <real_time_factor>2.0</real_time_factor>  \x3c!-- Runs at 2x real-time --\x3e\n</physics>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"collision-optimization",children:"Collision Optimization"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Use simple collision shapes --\x3e\n<collision name="simplified">\n  <geometry>\n    <cylinder radius="0.05" length="0.4"/>  \x3c!-- Fast --\x3e\n  </geometry>\n</collision>\n\n\x3c!-- Instead of complex meshes --\x3e\n<collision name="detailed">\n  <geometry>\n    <mesh>\n      <uri>detailed_mesh.stl</uri>  \x3c!-- Slow --\x3e\n    </mesh>\n  </geometry>\n</collision>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"level-of-detail-lod",children:"Level of Detail (LOD)"}),"\n",(0,s.jsx)(e.p,{children:"For large environments, use simplified visuals at a distance:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<visual name="far_view">\n  <geometry>\n    <box size="1 1 1"/>  \x3c!-- Simple box for distant viewing --\x3e\n  </geometry>\n</visual>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"creating-custom-gazebo-models",children:"Creating Custom Gazebo Models"}),"\n",(0,s.jsx)(e.h3,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"my_humanoid_gazebo/\n\u251c\u2500\u2500 model.config\n\u251c\u2500\u2500 model.sdf\n\u2514\u2500\u2500 meshes/\n    \u251c\u2500\u2500 torso.stl\n    \u251c\u2500\u2500 head.dae\n    \u2514\u2500\u2500 leg.obj\n"})}),"\n",(0,s.jsx)(e.h3,{id:"modelconfig",children:"model.config"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<model>\n  <name>My Humanoid</name>\n  <version>1.0</version>\n  <sdf version="1.6">model.sdf</sdf>\n\n  <author>\n    <name>Your Name</name>\n    <email>you@example.com</email>\n  </author>\n\n  <description>\n    A humanoid robot for Physical AI research\n  </description>\n</model>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"modelsdf-simplified",children:"model.sdf (Simplified)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.6">\n  <model name="my_humanoid">\n    <static>false</static>\n\n    <link name="torso">\n      <pose>0 0 1.0 0 0 0</pose>\n      <inertial>\n        <mass>30.0</mass>\n        <inertia>\n          <ixx>2.5</ixx>\n          <iyy>2.5</iyy>\n          <izz>0.5</izz>\n        </inertia>\n      </inertial>\n      <visual name="visual">\n        <geometry>\n          <mesh>\n            <uri>model://my_humanoid/meshes/torso.stl</uri>\n          </mesh>\n        </geometry>\n      </visual>\n      <collision name="collision">\n        <geometry>\n          <box>\n            <size>0.3 0.4 0.6</size>\n          </box>\n        </geometry>\n      </collision>\n    </link>\n\n    \x3c!-- Add more links and joints here --\x3e\n\n  </model>\n</sdf>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"installing-custom-models",children:"Installing Custom Models"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Copy to Gazebo model path\nmkdir -p ~/.gazebo/models\ncp -r my_humanoid_gazebo ~/.gazebo/models/\n\n# Or set environment variable\nexport GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:~/my_models\n"})}),"\n",(0,s.jsx)(e.h2,{id:"debugging-simulation-issues",children:"Debugging Simulation Issues"}),"\n",(0,s.jsx)(e.h3,{id:"common-problems-and-solutions",children:"Common Problems and Solutions"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Problem: Robot falls through ground"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"\x3c!-- Solution: Increase contact stiffness --\x3e\n<surface>\n  <contact>\n    <ode>\n      <kp>10000000.0</kp>\n      <min_depth>0.001</min_depth>\n    </ode>\n  </contact>\n</surface>\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Problem: Robot explodes or shakes violently"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Solution: Reduce step size, increase damping --\x3e\n<physics>\n  <max_step_size>0.0001</max_step_size>\n</physics>\n\n<joint name="knee">\n  <dynamics>\n    <damping>10.0</damping>  \x3c!-- Increase damping --\x3e\n  </dynamics>\n</joint>\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Problem: Simulation runs too slowly"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Check real-time factor\ngz stats\n\n# Enable GPU acceleration (if available)\nexport GAZEBO_USE_GPU=1\n"})}),"\n",(0,s.jsx)(e.h3,{id:"visualization-tools",children:"Visualization Tools"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# View joint states\nros2 topic echo /joint_states\n\n# Monitor contact forces\ngz topic -e /gazebo/default/physics/contacts\n\n# Check model tree\ngz model -m my_robot -i\n"})}),"\n",(0,s.jsx)(e.h2,{id:"practical-exercise-building-a-humanoid-test-arena",children:"Practical Exercise: Building a Humanoid Test Arena"}),"\n",(0,s.jsx)(e.p,{children:"Let's create a complete testing environment:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.6">\n  <world name="humanoid_arena">\n\n    <physics type="dart">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n    </physics>\n\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Flat walking area --\x3e\n    <model name="flat_surface">\n      <static>true</static>\n      <pose>0 0 0 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>10 10 0.1</size>\n            </box>\n          </geometry>\n          <surface>\n            <friction>\n              <ode>\n                <mu>1.5</mu>\n                <mu2>1.5</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>10 10 0.1</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.5 0.5 0.5 1</ambient>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Ramp for testing climbing --\x3e\n    <model name="ramp">\n      <static>true</static>\n      <pose>5 0 0.25 0 0.2 0</pose>  \x3c!-- 11.5 degree slope --\x3e\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>2 2 0.1</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>2 2 0.1</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.3 0.3 0.8 1</ambient>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Stairs --\x3e\n    <model name="stairs">\n      <static>true</static>\n      <pose>-3 0 0 0 0 0</pose>\n      <link name="step1">\n        <pose>0 0 0.1 0 0 0</pose>\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n        </visual>\n      </link>\n      <link name="step2">\n        <pose>0.3 0 0.3 0 0 0</pose>\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n        </visual>\n      </link>\n      \x3c!-- Add more steps --\x3e\n    </model>\n\n  </world>\n</sdf>\n'})}),"\n",(0,s.jsx)(e.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,s.jsx)(e.p,{children:"After completing this chapter, you should be able to:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Understand the role of digital twins in robotics development"}),"\n",(0,s.jsx)(e.li,{children:"Set up and configure Gazebo simulation environments"}),"\n",(0,s.jsx)(e.li,{children:"Choose appropriate physics engines for different robot types"}),"\n",(0,s.jsx)(e.li,{children:"Create realistic world files with proper gravity, friction, and collision properties"}),"\n",(0,s.jsx)(e.li,{children:"Build complex environments with obstacles and interactive objects"}),"\n",(0,s.jsx)(e.li,{children:"Spawn and control robots in simulation"}),"\n",(0,s.jsx)(e.li,{children:"Optimize simulation performance for training and testing"}),"\n",(0,s.jsx)(e.li,{children:"Debug common simulation issues"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Digital twins enable safe, rapid prototyping of Physical AI systems"}),"\n",(0,s.jsx)(e.li,{children:"Gazebo provides accurate physics simulation with multiple engine options"}),"\n",(0,s.jsx)(e.li,{children:"DART engine is best for humanoid bipedal locomotion"}),"\n",(0,s.jsx)(e.li,{children:"Proper contact properties (friction, stiffness, damping) are critical for realistic simulation"}),"\n",(0,s.jsx)(e.li,{children:"Collision geometry should be simplified for performance"}),"\n",(0,s.jsx)(e.li,{children:"World files use SDF format to define complete simulation environments"}),"\n",(0,s.jsx)(e.li,{children:"Gazebo plugins enable ROS 2 integration for robot control"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Next"}),": We'll explore high-fidelity rendering and human-robot interaction using Unity for more realistic visualizations."]})]})}function m(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>t,x:()=>a});var o=i(6540);const s={},l=o.createContext(s);function t(n){const e=o.useContext(l);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),o.createElement(l.Provider,{value:e},n.children)}}}]);